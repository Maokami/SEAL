<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.7"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>SEAL: seal::util::DWTHandler&lt; ValueType, RootType, ScalarType &gt; Class Template Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">SEAL
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.7 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><b>seal</b></li><li class="navelem"><b>util</b></li><li class="navelem"><a class="el" href="classseal_1_1util_1_1_d_w_t_handler.html">DWTHandler</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classseal_1_1util_1_1_d_w_t_handler-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">seal::util::DWTHandler&lt; ValueType, RootType, ScalarType &gt; Class Template Reference</div></div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="dwthandler_8h_source.html">dwthandler.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a108e165a084f02f79f5b4967de271f45"><td class="memItemLeft" align="right" valign="top"><a id="a108e165a084f02f79f5b4967de271f45" name="a108e165a084f02f79f5b4967de271f45"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>DWTHandler</b> (const <a class="el" href="classseal_1_1util_1_1_arithmetic.html">Arithmetic</a>&lt; ValueType, RootType, ScalarType &gt; &amp;num_struct)</td></tr>
<tr class="separator:a108e165a084f02f79f5b4967de271f45"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ff0f528d011ff99c1c0c1ba241d50db"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classseal_1_1util_1_1_d_w_t_handler.html#a0ff0f528d011ff99c1c0c1ba241d50db">transform_to_rev</a> (ValueType *values, int log_n, const RootType *roots, const ScalarType *scalar=nullptr) const</td></tr>
<tr class="separator:a0ff0f528d011ff99c1c0c1ba241d50db"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5313d7bdfce1fc0b8750951a877a9a7e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classseal_1_1util_1_1_d_w_t_handler.html#a5313d7bdfce1fc0b8750951a877a9a7e">transform_from_rev</a> (ValueType *values, int log_n, const RootType *roots, const ScalarType *scalar=nullptr) const</td></tr>
<tr class="separator:a5313d7bdfce1fc0b8750951a877a9a7e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><div class="compoundTemplParams">template&lt;typename ValueType, typename RootType, typename ScalarType&gt;<br />
class seal::util::DWTHandler&lt; ValueType, RootType, ScalarType &gt;</div><p>Provides an interface that performs the fast discrete weighted transform (DWT) and its inverse that are used to accelerate polynomial multiplications, batch multiple messages into a single plaintext polynomial. This class template is specialized with integer modular arithmetic for DWT over integer quotient rings, and is used in polynomial multiplications and <a class="el" href="classseal_1_1_batch_encoder.html">BatchEncoder</a>. It is also specialized with double-precision complex arithmetic for DWT over the complex field, which is used in <a class="el" href="classseal_1_1_c_k_k_s_encoder.html">CKKSEncoder</a>.</p>
<dl class="section user"><dt>The discrete weighted transform (DWT) is a variantion on the discrete Fourier transform (DFT) over</dt><dd>arbitrary rings involving weighing the input before transforming it by multiplying element-wise by a weight vector, then weighing the output by another vector. The DWT can be used to perform negacyclic convolution on vectors just like how the DFT can be used to perform cyclic convolution. The DFT of size n requires a primitive n-th root of unity, while the DWT for negacyclic convolution requires a primitive 2n-th root of unity, \psi. In the forward DWT, the input is multiplied element-wise with an incrementing power of \psi, the forward DFT transform uses the 2n-th primitve root of unity \psi^2, and the output is not weighed. In the backward DWT, the input is not weighed, the backward DFT transform uses the 2n-th primitve root of unity \psi^{-2}, and the output is multiplied element-wise with an incrementing power of \psi^{-1}.</dd></dl>
<dl class="section user"><dt>A fast Fourier transform is an algorithm that computes the DFT or its inverse. The Cooley-Tukey FFT reduces</dt><dd>the complexity of the DFT from O(n^2) to O(n\log{n}). The DFT can be interpretted as evaluating an (n-1)-degree polynomial at incrementing powers of a primitive n-th root of unity, which can be accelerated by FFT algorithms. The DWT evaluates incrementing odd powers of a primitive 2n-th root of unity, and can also be accelerated by FFT-like algorithms implemented in this class.</dd></dl>
<dl class="section user"><dt>Algorithms implemented in this class are based on algorithms 1 and 2 in the paper by Patrick Longa and</dt><dd>Michael Naehrig (<a href="https://eprint.iacr.org/2016/504.pdf">https://eprint.iacr.org/2016/504.pdf</a>) with three modifications. First, we generalize in this class the algorithms to DWT over arbitrary rings. Second, the powers of \psi^{-1} used by the IDWT are stored in a scrambled order (in contrast to bit-reversed order in paper) to create coalesced memory accesses. Third, the multiplication with 1/n in the IDWT is merged to the last iteration, saving n/2 multiplications. Last, we unroll the loops to create coalesced memory accesses to input and output vectors. In earlier versions of SEAL, the mutiplication with 1/n is done by merging a multiplication of 1/2 in all interations, which is slower than the current method on CPUs but more efficient on some hardware architectures.</dd></dl>
<dl class="section user"><dt>The order in which the powers of \psi^{-1} used by the IDWT are stored is unnatural but efficient:</dt><dd>the i-th slot stores the (reverse_bits(i - 1, log_n) + 1)-th power of \psi^{-1}. </dd></dl>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a id="a5313d7bdfce1fc0b8750951a877a9a7e" name="a5313d7bdfce1fc0b8750951a877a9a7e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5313d7bdfce1fc0b8750951a877a9a7e">&#9670;&#160;</a></span>transform_from_rev()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename ValueType , typename RootType , typename ScalarType &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classseal_1_1util_1_1_d_w_t_handler.html">seal::util::DWTHandler</a>&lt; ValueType, RootType, ScalarType &gt;::transform_from_rev </td>
          <td>(</td>
          <td class="paramtype">ValueType *&#160;</td>
          <td class="paramname"><em>values</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>log_n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const RootType *&#160;</td>
          <td class="paramname"><em>roots</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const ScalarType *&#160;</td>
          <td class="paramname"><em>scalar</em> = <code>nullptr</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Performs in place a fast multiplication with the DWT matrix. Accesses to powers of root is coalesced. Accesses to values is not coalesced without loop unrolling.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">[values]</td><td>inputs in bit-reversed order, outputs in normal order </td></tr>
    <tr><td class="paramname">[roots]</td><td>powers of a root in scrambled order </td></tr>
    <tr><td class="paramname">[scalar]</td><td>an optional scalar that is multiplied to all output values </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a0ff0f528d011ff99c1c0c1ba241d50db" name="a0ff0f528d011ff99c1c0c1ba241d50db"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0ff0f528d011ff99c1c0c1ba241d50db">&#9670;&#160;</a></span>transform_to_rev()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename ValueType , typename RootType , typename ScalarType &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classseal_1_1util_1_1_d_w_t_handler.html">seal::util::DWTHandler</a>&lt; ValueType, RootType, ScalarType &gt;::transform_to_rev </td>
          <td>(</td>
          <td class="paramtype">ValueType *&#160;</td>
          <td class="paramname"><em>values</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>log_n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const RootType *&#160;</td>
          <td class="paramname"><em>roots</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const ScalarType *&#160;</td>
          <td class="paramname"><em>scalar</em> = <code>nullptr</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Performs in place a fast multiplication with the DWT matrix. Accesses to powers of root is coalesced. Accesses to values is not coalesced without loop unrolling.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">[values]</td><td>inputs in normal order, outputs in bit-reversed order </td></tr>
    <tr><td class="paramname">[log_n]</td><td>log 2 of the DWT size </td></tr>
    <tr><td class="paramname">[roots]</td><td>powers of a root in bit-reversed order </td></tr>
    <tr><td class="paramname">[scalar]</td><td>an optional scalar that is multiplied to all output values </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>seal/util/<a class="el" href="dwthandler_8h_source.html">dwthandler.h</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.7
</small></address>
</body>
</html>
